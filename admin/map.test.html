<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>주소 검색 및 마커 표시</title>
    <style>
        #map { width: 100%; height: 500px; }
    </style>
    <!-- 브이월드 맵 API 불러오기 -->
    <script type="text/javascript" src="https://map.vworld.kr/js/vworldMapInit.js.do?apiKey=56E398AA-1CA6-39E1-B90B-997708F6A41C"></script>
</head>
<body>
    <input type="text" id="address" placeholder="주소를 입력하세요">
    <button onclick="searchAddress()">검색</button>
    <div id="map"></div>
    <script>
        // 지도 초기화
        var map = new Map('map', {
            center: [126.9784, 37.5665], // 초기 중심 좌표 (서울 시청)
            zoom: 9 // 초기 줌 레벨
        });

        // 마커 레이어 생성
        var markerLayer = new VectorLayer();
        map.addLayer(markerLayer);

        // 주소 검색 함수
        function searchAddress() {
            var address = document.getElementById('address').value;
            if (!address) {
                alert('주소를 입력하세요.');
                return;
            }

            // 브이월드 지오코딩 API 요청
            var xhr = new XMLHttpRequest();
            var url = 'https://api.vworld.kr/req/address?service=address&request=getCoord&version=2.0&crs=epsg:4326&address='
                + encodeURIComponent(address) + '&refine=true&simple=false&format=json&type=road&key=56E398AA-1CA6-39E1-B90B-997708F6A41C';
            xhr.open('GET', url, true);
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    var result = JSON.parse(xhr.responseText);
                    if (result.response.status === 'OK') {
                        var point = result.response.result.point;
                        var coord = [parseFloat(point.x), parseFloat(point.y)];

                        // 지도 중심 이동
                        map.setCenter(coord);
                        map.setZoom(16);

                        // 기존 마커 제거
                        markerLayer.clear();

                        // 새로운 마커 추가
                        var marker = new Feature({
                            geometry: new Point(coord)
                        });
                        markerLayer.addFeature(marker);
                    } else {
                        alert('주소를 찾을 수 없습니다.');
                    }
                }
            };
            xhr.send();
        }
    </script>
</body>
</html>
